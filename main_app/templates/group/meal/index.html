{% extends 'base.html' %}

{% block content %}
{% load custom_tags %}

<h2>Week of: {{ week_days.0|date:"M d" }} - {{ week_days.6|date:"M d" }}</h2>
<div>
    <a href="{% url 'meal_calendar_with_date' collab_group.id prev_year prev_week %}">Previous Week</a>
    <a href="{% url 'meal_calendar_with_date' collab_group.id next_year next_week %}">Next Week</a>
</div>

<div class="meal-planner-container">
  <div class="calendar-week-view">
    <table>
      <thead>
        <tr>
            <th></th>
            {% for day in week_days %}
            <th class="day-name">{{ day|date:"l" }}<br>{{ day|date:"M d" }}</th>
            {% endfor %}
        </tr>
      </thead>
      <tbody>

        <tr>
            <td class="meal-type">Breakfast</td>
            {% for day in week_days %}
                <td>
                    {% with meals=meals_by_day_type|get_item:day.weekday %}
                        {% with meal=meals.B %}
                {% if meal %}
                    {{ meal.recipe.title }}
                {% else %}
                    No breakfast assigned
                {% endif %}
            {% endwith %}
        {% endwith %}
                </td>
            {% endfor %}
        </tr>

        <tr>
            <td class="meal-type">Lunch</td>
            {% for day in week_days %}
                <td>
                    {% with meals=meals_by_day_type|get_item:day.weekday %}
            {% with meal=meals.L %}
                {% if meal %}
                    {{ meal.recipe.title }}
                {% else %}
                    No lunch assigned
                {% endif %}
            {% endwith %}
        {% endwith %}
                </td>
            {% endfor %}
        </tr>

        <tr>
            <td class="meal-type">Dinner</td>
            {% for day in week_days %}
                <td>
                    {% with meals=meals_by_day_type|get_item:day.weekday %}
            {% with meal=meals.D %}
                {% if meal %}
                    {{ meal.recipe.title }}
                {% else %}
                    No dinner assigned
                {% endif %}
            {% endwith %}
        {% endwith %}
                </td>
            {% endfor %}
        </tr>
    </tbody>
    </table>
  </div>

  <div class="recipe-detail-view">
    <h2>Selected Meal: Banana Oatmeal Pancakes</h2>
    <p><strong>Date:</strong> Weds, Jan 17</p>
    <p><strong>Ingredients:</strong></p>
    <ul>
      <li>2 bananas</li>
      <li>2 eggs</li>
    </ul>
    <p><strong>Instructions:</strong></p>
    <ol>
      <li>
        Add all of the ingredients to a blender and blend on high until
        completely smooth, about 30 seconds.
      </li>
    </ol>
  </div>
</div>

<div id="meal-modal" style="display: none">
  <form method="POST" action="">
    {% csrf_token %}

    {{ meal_form.as_p }}
    <input type="submit" value="Assign Meal" />
  </form>
</div>

{% endblock %}